---
/**
 * Componente Astro per la visualizzazione di un report.
 * Aspetto curioso √® la scelta limitata delle lingue supportate per i report,
 * che sono solo italiano e inglese. Questo √® dovuto al fatto che i report, al
 * momento, sono disponibili solo in queste due lingue.
 * Se in futuro dovessero essere aggiunte altre lingue, sar√† necessario aggiornare il
 * codice. Questo approccio assicura che gli sviluppatori siano consapevoli delle lingue
 * supportate, riducendo al contempo le probabilit√† di un errore di digitazione da parte loro.
 */
interface Props {
  coverUrl: ImageMetadata;
  pdfUrl: string;
  pdfSize: number;
  pdfPages: number;
  pdfLanguage: "it" | "en";
}

const { coverUrl, pdfUrl, pdfSize, pdfPages, pdfLanguage }: Props = Astro.props;

let languageLabel: string | undefined = undefined;
switch (pdfLanguage) {
  case "it":
    languageLabel = "Italiano";
    break;
  case "en":
    languageLabel = "Inglese";
    break;
  default:
    /** Sebbene al momento non sia mai possibile giungere a questo `default`,
     * √® stato inserito per sicurezza, in modo da avvisare gli sviluppatori qualora
     * in futuro aggiungano una nuova lingua supportata senza aggiornare questo
     * pezzetto di codice che si occupa di mappare le lingue supportate in una label leggibile.
     */
    languageLabel = "NON MAPPATA"; // Visibile agli utenti finali
    console.warn("Lingua del documento non mappata:", pdfLanguage); // Gli sviluppatori vedranno questo messaggio nella console del browser
}
---

<section class="report card">
  <img src={coverUrl.src} alt="" class="cover" />

  <div class="content">
    <slot />

    <p>
      <small>
        üí° Riassunto generato con l'intelligenza artificiale di ChatGPT. Pu√≤
        contenere errori e imprecisioni.
      </small>
    </p>

    <div class="meta">
      <p>
        <strong>Formato file:</strong> PDF
      </p>
      <p>
        <strong>Numero di pagine:</strong>
        {pdfPages}
      </p>
      <p>
        <strong>Dimensione del file:</strong>
        {pdfSize} MB
      </p>
      <p>
        <strong>Lingua del documento:</strong>
        {languageLabel}
      </p>
    </div>

    <p>
      Puoi scegliere di visualizzare il report online oppure di scaricarlo in
      formato PDF.
    </p>

    <div class="actions">
      <a href={pdfUrl} class="button">üìÉ Consulta online</a>
       <!-- L'attributo `download` √® stato introdotto con HTML5 e indica al browser
        di non renderizzare il contenuto del link, ma di scaricarlo direttamente -->
      <a href={pdfUrl} class="button" download>
        ‚¨áÔ∏è Scarica in PDF <small>[{pdfSize} MB]</small>
      </a>
    </div>
  </div>
</section>

<style lang="scss">
  $breakpoint: 800px;

  .card {
    padding: 0;
    display: flex;
    gap: 2rem;

    @media (width <= $breakpoint) {
      display: block;
    }

    .cover {
      border-radius: 0.5rem 0 0 0.5rem;
      width: 100%;
      max-width: 300px;

      // Impostazioni per l'immagine di copertura, che si adatta al layout
      height: auto;
      object-fit: cover;
      object-position: center;

      @media (width <= $breakpoint) {
        max-width: none;
        border-radius: 0.5rem 0.5rem 0 0;
        object-position: top;
        max-height: 200px;
      }
    }

    .content {
      padding: 2rem;
      padding-left: 0;
      flex: 1;

      @media (width <= $breakpoint) {
        padding: 1rem;
      }
    }

    .meta {
      margin: 2rem 0;
      font-size: 0.9rem;
      padding: 1rem;
      background-color: var(--background-color);
      border-radius: 0.5rem;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap: 0.5rem;

      @media (width <= 1100px) {
        grid-template-columns: 1fr 1fr;
      }
    }
  }

  .actions {
    display: flex;
    gap: 1rem;
  }
</style>
